{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Jesse/Documents/cartfax_complete_v2/pages/admin/batches/%5Bid%5D.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport { useSession } from 'next-auth/react';\r\n\r\ntype Brand = {\r\n  id: number;\r\n  name: string;\r\n};\r\n\r\ntype ReviewAggregate = {\r\n  ratingAvg: number;\r\n  ratingCount: number;\r\n};\r\n\r\ntype RatingSource = {\r\n  id: number;\r\n  source: string;\r\n  ratingAvg: number;\r\n  ratingCount: number;\r\n};\r\n\r\ntype Lab = {\r\n  id: number;\r\n  name: string;\r\n};\r\n\r\ntype UploadedDocument = {\r\n  id: number;\r\n  fileName: string;\r\n};\r\n\r\ntype LabResult = {\r\n  id: number;\r\n  testedAt?: string | null;\r\n  reportedAt?: string | null;\r\n  thcPercent?: number | null;\r\n  cbdPercent?: number | null;\r\n  totalCannabinoidsPercent?: number | null;\r\n  passed?: boolean | null;\r\n  lab?: Lab | null;\r\n  uploadedDocument?: UploadedDocument | null;\r\n};\r\n\r\ntype BatchLocation = {\r\n  id: number;\r\n  location: {\r\n    id: number;\r\n    name: string;\r\n    city?: string | null;\r\n    state?: string | null;\r\n    type: string;\r\n  };\r\n};\r\n\r\ntype VerificationEvent = {\r\n  id: number;\r\n  status: string;\r\n  reason?: string | null;\r\n  createdAt: string;\r\n  createdBy?: string | null;\r\n};\r\n\r\ntype Recall = {\r\n  id: number;\r\n  jurisdiction: string;\r\n  recallNumber?: string | null;\r\n  status: string;\r\n  reason?: string | null;\r\n  issuedAt?: string | null;\r\n};\r\n\r\ntype BatchDetail = {\r\n  id: number;\r\n  batchCode: string;\r\n  productName?: string | null;\r\n  productSku?: string | null;\r\n  primaryCategory?: string | null;\r\n  subCategory?: string | null;\r\n  brand?: Brand | null;\r\n  harvestDate?: string | null;\r\n  productionDate?: string | null;\r\n  packageDate?: string | null;\r\n  expirationDate?: string | null;\r\n  isActive: boolean;\r\n  notes?: string | null;\r\n  reviewAggregate?: ReviewAggregate | null;\r\n  ratingSources: RatingSource[];\r\n  labResults: LabResult[];\r\n  locations: BatchLocation[];\r\n  verifications: VerificationEvent[];\r\n  recalls: Recall[];\r\n};\r\n\r\nfunction formatDate(s?: string | null) {\r\n  if (!s) return '—';\r\n  const d = new Date(s);\r\n  if (Number.isNaN(d.getTime())) return '—';\r\n  return d.toLocaleDateString();\r\n}\r\n\r\nfunction latestVerification(verifications: VerificationEvent[]) {\r\n  if (!verifications || verifications.length === 0) return null;\r\n  return verifications[0];\r\n}\r\n\r\nfunction overallStatus(batch: BatchDetail) {\r\n  const latest = latestVerification(batch.verifications);\r\n  const hasActiveRecall = batch.recalls.some((r) => r.status === 'ACTIVE');\r\n\r\n  if (hasActiveRecall) return 'RECALLED';\r\n  if (latest?.status === 'FLAGGED') return 'FLAGGED';\r\n  if (latest?.status === 'REJECTED') return 'REJECTED';\r\n  if (latest?.status === 'VERIFIED') return 'VERIFIED';\r\n  return 'UNVERIFIED';\r\n}\r\n\r\nexport default function AdminBatchDetail() {\r\n  const { data: session } = useSession();\r\n  const router = useRouter();\r\n  const { id } = router.query;\r\n\r\n  const [batch, setBatch] = useState<BatchDetail | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // NEW: track which lab result is being deleted\r\n  const [deletingLabResultId, setDeletingLabResultId] =\r\n    useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!id || !session) return;\r\n    fetchBatch(id);\r\n  }, [id, session]);\r\n\r\n  async function fetchBatch(batchId: string | string[]) {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const idStr = Array.isArray(batchId) ? batchId[0] : batchId;\r\n      const res = await fetch(`/api/admin/batches/${idStr}`);\r\n      if (!res.ok) {\r\n        const txt = await res.text();\r\n        throw new Error(txt || 'Failed to load batch');\r\n      }\r\n      const data = await res.json();\r\n      setBatch(data);\r\n    } catch (e: any) {\r\n      console.error('Failed to load batch', e);\r\n      setError(e.message || 'Failed to load batch');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  // NEW: delete COA / lab result handler\r\n  async function handleDeleteLabResult(labResultId: number) {\r\n    if (!id) return;\r\n\r\n    if (typeof window !== 'undefined') {\r\n      const ok = window.confirm(\r\n        'Delete this COA and its lab result from this batch? This cannot be undone.'\r\n      );\r\n      if (!ok) return;\r\n    }\r\n\r\n    try {\r\n      setDeletingLabResultId(labResultId);\r\n      setError(null);\r\n\r\n      const res = await fetch(`/api/admin/lab-results/${labResultId}`, {\r\n        method: 'DELETE',\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const txt = await res.text();\r\n        throw new Error(txt || 'Failed to delete lab result / COA');\r\n      }\r\n\r\n      await fetchBatch(id);\r\n    } catch (e: any) {\r\n      console.error('Failed to delete lab result / COA', e);\r\n      setError(e.message || 'Failed to delete lab result / COA');\r\n    } finally {\r\n      setDeletingLabResultId(null);\r\n    }\r\n  }\r\n\r\n  if (!session) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <p className=\"text-sm text-slate-300\">\r\n          Sign in as an admin to view batch details.\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (loading && !batch) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <p className=\"text-sm text-slate-300\">Loading batch…</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error && !batch) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <p className=\"text-sm text-red-400\">Error: {error}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!batch) {\r\n    return (\r\n      <div className=\"p-6\">\r\n        <p className=\"text-sm text-slate-300\">Batch not found.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const status = overallStatus(batch);\r\n  const ver = latestVerification(batch.verifications);\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-6xl mx-auto space-y-6\">\r\n      {/* Top bar / breadcrumb */}\r\n      <div className=\"flex items-center justify-between gap-4\">\r\n        <div>\r\n          <button\r\n            onClick={() => router.push('/admin/batches')}\r\n            className=\"text-xs text-slate-400 hover:text-emerald-400 mb-1\"\r\n          >\r\n            ← Back to batches\r\n          </button>\r\n          <h1 className=\"text-2xl font-semibold text-slate-100\">\r\n            {batch.productName || batch.batchCode}\r\n          </h1>\r\n          <p className=\"text-sm text-slate-400\">\r\n            Batch code{' '}\r\n            <span className=\"font-mono text-slate-200\">\r\n              {batch.batchCode}\r\n            </span>\r\n            {batch.brand && (\r\n              <>\r\n                {' '}\r\n                · Brand:{' '}\r\n                <span className=\"text-slate-100\">{batch.brand.name}</span>\r\n              </>\r\n            )}\r\n          </p>\r\n        </div>\r\n        <div className=\"flex flex-col items-end gap-2\">\r\n          {/* Status pill */}\r\n          <div className=\"flex gap-2\">\r\n            <span\r\n              className={`px-2 py-1 rounded-full text-[11px] border ${\r\n                status === 'VERIFIED'\r\n                  ? 'border-emerald-500 text-emerald-300'\r\n                  : status === 'RECALLED'\r\n                  ? 'border-red-500 text-red-300'\r\n                  : status === 'FLAGGED' || status === 'REJECTED'\r\n                  ? 'border-amber-500 text-amber-300'\r\n                  : 'border-slate-600 text-slate-300'\r\n              }`}\r\n            >\r\n              {status}\r\n            </span>\r\n            {!batch.isActive && (\r\n              <span className=\"px-2 py-1 rounded-full text-[11px] border border-slate-600 text-slate-400\">\r\n                Inactive\r\n              </span>\r\n            )}\r\n          </div>\r\n\r\n          {/* Rating summary */}\r\n          {batch.reviewAggregate ? (\r\n            <div className=\"text-xs text-emerald-300\">\r\n              ★ {batch.reviewAggregate.ratingAvg.toFixed(1)} / 5 ({' '}\r\n              {batch.reviewAggregate.ratingCount}{' '}\r\n              {batch.reviewAggregate.ratingCount === 1\r\n                ? 'rating'\r\n                : 'ratings'}\r\n              )\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-xs text-slate-500\">No ratings yet</div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Error banner if something went wrong but we still have data */}\r\n      {error && batch && (\r\n        <div className=\"text-xs text-red-300 bg-red-950/40 border border-red-700/60 rounded-md px-3 py-2\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* Layout: left = overview, right = status/recall */}\r\n      <div className=\"grid gap-4 md:grid-cols-[minmax(0,2fr)_minmax(0,1.3fr)]\">\r\n        {/* Overview card */}\r\n        <div className=\"rounded-xl border border-slate-800 bg-slate-900/70 p-4 space-y-3\">\r\n          <h2 className=\"text-sm font-semibold text-slate-200 mb-1\">\r\n            Overview\r\n          </h2>\r\n          <div className=\"grid text-sm gap-2 md:grid-cols-2\">\r\n            <div>\r\n              <div className=\"text-xs text-slate-400\">Batch code</div>\r\n              <div className=\"font-mono text-slate-100\">\r\n                {batch.batchCode}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-slate-400\">Product</div>\r\n              <div className=\"text-slate-100\">\r\n                {batch.productName || '—'}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-slate-400\">Category</div>\r\n              <div className=\"text-slate-100\">\r\n                {batch.primaryCategory || '—'}\r\n                {batch.subCategory\r\n                  ? ` · ${batch.subCategory}`\r\n                  : ''}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-slate-400\">SKU</div>\r\n              <div className=\"text-slate-100\">\r\n                {batch.productSku || '—'}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-slate-400\">Harvest date</div>\r\n              <div className=\"text-slate-100\">\r\n                {formatDate(batch.harvestDate)}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-slate-400\">\r\n                Production date\r\n              </div>\r\n              <div className=\"text-slate-100\">\r\n                {formatDate(batch.productionDate)}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-slate-400\">Package date</div>\r\n              <div className=\"text-slate-100\">\r\n                {formatDate(batch.packageDate)}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-slate-400\">Expiration date</div>\r\n              <div className=\"text-slate-100\">\r\n                {formatDate(batch.expirationDate)}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {batch.notes && (\r\n            <div className=\"pt-2 border-t border-slate-800 mt-2\">\r\n              <div className=\"text-xs text-slate-400 mb-1\">Notes</div>\r\n              <p className=\"text-xs text-slate-200 whitespace-pre-wrap\">\r\n                {batch.notes}\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Status / recall / verification */}\r\n        <div className=\"space-y-4\">\r\n          {/* Verification card */}\r\n          <div className=\"rounded-xl border border-slate-800 bg-slate-900/70 p-4 text-sm\">\r\n            <h2 className=\"text-sm font-semibold text-slate-200 mb-2\">\r\n              Verification\r\n            </h2>\r\n            {ver ? (\r\n              <div className=\"space-y-1\">\r\n                <div className=\"text-xs text-slate-400\">\r\n                  Latest status\r\n                </div>\r\n                <div className=\"text-slate-100\">\r\n                  {ver.status}{' '}\r\n                  <span className=\"text-xs text-slate-500\">\r\n                    on {formatDate(ver.createdAt)}\r\n                    {ver.createdBy ? ` by ${ver.createdBy}` : ''}\r\n                  </span>\r\n                </div>\r\n                {ver.reason && (\r\n                  <div className=\"text-xs text-slate-300 mt-1\">\r\n                    {ver.reason}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-xs text-slate-500\">\r\n                No verification events recorded yet.\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Recalls card */}\r\n          <div className=\"rounded-xl border border-slate-800 bg-slate-900/70 p-4 text-sm\">\r\n            <h2 className=\"text-sm font-semibold text-slate-200 mb-2\">\r\n              Recalls\r\n            </h2>\r\n            {batch.recalls.length === 0 ? (\r\n              <div className=\"text-xs text-slate-500\">\r\n                No recalls recorded for this batch.\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-2\">\r\n                {batch.recalls.map((r) => (\r\n                  <div\r\n                    key={r.id}\r\n                    className=\"border border-slate-800 rounded-md px-2 py-1.5\"\r\n                  >\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"text-xs text-slate-300\">\r\n                        {r.jurisdiction}{' '}\r\n                        {r.recallNumber ? `· ${r.recallNumber}` : ''}\r\n                      </div>\r\n                      <span\r\n                        className={`text-[10px] px-2 py-0.5 rounded-full border ${\r\n                          r.status === 'ACTIVE'\r\n                            ? 'border-red-500 text-red-300'\r\n                            : 'border-slate-600 text-slate-300'\r\n                        }`}\r\n                      >\r\n                        {r.status}\r\n                      </span>\r\n                    </div>\r\n                    {r.reason && (\r\n                      <div className=\"text-[11px] text-slate-400 mt-1\">\r\n                        {r.reason}\r\n                      </div>\r\n                    )}\r\n                    {r.issuedAt && (\r\n                      <div className=\"text-[11px] text-slate-500 mt-1\">\r\n                        Issued: {formatDate(r.issuedAt)}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Lab results section */}\r\n      <div className=\"rounded-xl border border-slate-800 bg-slate-900/70 p-4\">\r\n        <h2 className=\"text-sm font-semibold text-slate-200 mb-2\">\r\n          Lab results (COAs)\r\n        </h2>\r\n        {batch.labResults.length === 0 ? (\r\n          <div className=\"text-xs text-slate-500\">\r\n            No lab results linked to this batch yet.\r\n          </div>\r\n        ) : (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full text-xs text-left border-collapse\">\r\n              <thead>\r\n                <tr className=\"border-b border-slate-800 text-slate-400\">\r\n                  <th className=\"py-2 pr-3\">Lab</th>\r\n                  <th className=\"py-2 pr-3\">Tested at</th>\r\n                  <th className=\"py-2 pr-3\">THC %</th>\r\n                  <th className=\"py-2 pr-3\">CBD %</th>\r\n                  <th className=\"py-2 pr-3\">Total cannabinoids %</th>\r\n                  <th className=\"py-2 pr-3\">Overall</th>\r\n                  <th className=\"py-2 pr-3\">COA</th>\r\n                  <th className=\"py-2 pr-3\">Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {batch.labResults.map((lr) => (\r\n                  <tr\r\n                    key={lr.id}\r\n                    className=\"border-b border-slate-900/70 hover:bg-slate-900/80\"\r\n                  >\r\n                    <td className=\"py-2 pr-3 text-slate-100\">\r\n                      {lr.lab?.name || '—'}\r\n                    </td>\r\n                    <td className=\"py-2 pr-3 text-slate-200\">\r\n                      {formatDate(lr.testedAt)}\r\n                    </td>\r\n                    <td className=\"py-2 pr-3 text-slate-200\">\r\n                      {lr.thcPercent != null\r\n                        ? `${lr.thcPercent.toFixed(2)}%`\r\n                        : '—'}\r\n                    </td>\r\n                    <td className=\"py-2 pr-3 text-slate-200\">\r\n                      {lr.cbdPercent != null\r\n                        ? `${lr.cbdPercent.toFixed(2)}%`\r\n                        : '—'}\r\n                    </td>\r\n                    <td className=\"py-2 pr-3 text-slate-200\">\r\n                      {lr.totalCannabinoidsPercent != null\r\n                        ? `${lr.totalCannabinoidsPercent.toFixed(2)}%`\r\n                        : '—'}\r\n                    </td>\r\n                    <td className=\"py-2 pr-3\">\r\n                      {lr.passed == null ? (\r\n                        <span className=\"text-slate-500\">Unknown</span>\r\n                      ) : lr.passed ? (\r\n                        <span className=\"text-emerald-300\">Pass</span>\r\n                      ) : (\r\n                        <span className=\"text-red-300\">Fail</span>\r\n                      )}\r\n                    </td>\r\n                    <td className=\"py-2 pr-3 text-slate-200\">\r\n                      {lr.uploadedDocument\r\n                        ? lr.uploadedDocument.fileName\r\n                        : '—'}\r\n                    </td>\r\n                    <td className=\"py-2 pr-3\">\r\n                      {lr.uploadedDocument ? (\r\n                        <button\r\n                          onClick={() => handleDeleteLabResult(lr.id)}\r\n                          disabled={deletingLabResultId === lr.id}\r\n                          className=\"text-[11px] px-2 py-1 rounded-md border border-red-600/70 text-red-300 hover:bg-red-900/40 disabled:opacity-60\"\r\n                        >\r\n                          {deletingLabResultId === lr.id\r\n                            ? 'Deleting…'\r\n                            : 'Delete COA'}\r\n                        </button>\r\n                      ) : (\r\n                        <span className=\"text-[11px] text-slate-500\">\r\n                          No COA attached\r\n                        </span>\r\n                      )}\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Locations section */}\r\n      <div className=\"rounded-xl border border-slate-800 bg-slate-900/70 p-4\">\r\n        <h2 className=\"text-sm font-semibold text-slate-200 mb-2\">\r\n          Locations (where seen / sold)\r\n        </h2>\r\n        {batch.locations.length === 0 ? (\r\n          <div className=\"text-xs text-slate-500\">\r\n            No locations linked to this batch yet.\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid gap-2 md:grid-cols-2 text-xs\">\r\n            {batch.locations.map((bl) => (\r\n              <div\r\n                key={bl.id}\r\n                className=\"border border-slate-800 rounded-md px-3 py-2\"\r\n              >\r\n                <div className=\"text-slate-100\">\r\n                  {bl.location.name}\r\n                </div>\r\n                <div className=\"text-slate-400\">\r\n                  {bl.location.city || '—'},{' '}\r\n                  {bl.location.state || '—'}\r\n                </div>\r\n                <div className=\"text-[10px] text-slate-500 mt-1\">\r\n                  Type: {bl.location.type}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Ratings section */}\r\n      <div className=\"rounded-xl border border-slate-800 bg-slate-900/70 p-4\">\r\n        <h2 className=\"text-sm font-semibold text-slate-200 mb-2\">\r\n          Ratings (5-star aggregate)\r\n        </h2>\r\n        {batch.reviewAggregate ? (\r\n          <div className=\"text-sm text-slate-200 mb-2\">\r\n            Overall:{' '}\r\n            <span className=\"text-emerald-300 font-semibold\">\r\n              ★ {batch.reviewAggregate.ratingAvg.toFixed(1)} / 5\r\n            </span>{' '}\r\n            ({batch.reviewAggregate.ratingCount}{' '}\r\n            {batch.reviewAggregate.ratingCount === 1\r\n              ? 'rating'\r\n              : 'ratings'}\r\n            )\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-xs text-slate-500 mb-2\">\r\n            No aggregate rating computed for this batch yet.\r\n          </div>\r\n        )}\r\n\r\n        {batch.ratingSources.length === 0 ? (\r\n          <div className=\"text-xs text-slate-500\">\r\n            No source-specific rating data available.\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid gap-2 md:grid-cols-3 text-xs\">\r\n            {batch.ratingSources.map((rs) => (\r\n              <div\r\n                key={rs.id}\r\n                className=\"border border-slate-800 rounded-md px-3 py-2\"\r\n              >\r\n                <div className=\"text-slate-200\">{rs.source}</div>\r\n                <div className=\"text-emerald-300\">\r\n                  ★ {rs.ratingAvg.toFixed(1)} / 5\r\n                </div>\r\n                <div className=\"text-slate-500\">\r\n                  {rs.ratingCount}{' '}\r\n                  {rs.ratingCount === 1 ? 'rating' : 'ratings'}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Verification history section */}\r\n      <div className=\"rounded-xl border border-slate-800 bg-slate-900/70 p-4\">\r\n        <h2 className=\"text-sm font-semibold text-slate-200 mb-2\">\r\n          Verification history\r\n        </h2>\r\n        {batch.verifications.length === 0 ? (\r\n          <div className=\"text-xs text-slate-500\">\r\n            No verification events yet.\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-2 text-xs\">\r\n            {batch.verifications.map((v) => (\r\n              <div\r\n                key={v.id}\r\n                className=\"border border-slate-800 rounded-md px-3 py-2\"\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"text-slate-200\">{v.status}</div>\r\n                  <div className=\"text-slate-500\">\r\n                    {formatDate(v.createdAt)}\r\n                    {v.createdBy ? ` · ${v.createdBy}` : ''}\r\n                  </div>\r\n                </div>\r\n                {v.reason && (\r\n                  <div className=\"text-slate-300 mt-1\">\r\n                    {v.reason}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}